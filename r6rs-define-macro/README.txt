This is the implementation for r6rs scheme. It still depends on the
low level macro system, define-macro, which is not portable.

This has been tested on:
  ypsilon

